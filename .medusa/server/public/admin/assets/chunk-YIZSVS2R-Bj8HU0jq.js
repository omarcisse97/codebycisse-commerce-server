import{ca as x,cb as g,r as c,cc as q,k as E}from"./index-CxRnuMVk.js";var S=()=>{const[a,s]=c.useState(""),[n,t]=c.useState(""),r=c.useCallback(q(i=>t(i),300),[]);return c.useEffect(()=>(r(a),()=>r.cancel()),[a,r]),{searchValue:a,onSearchValueChange:s,query:n||void 0}},I=({queryKey:a,queryFn:s,getOptions:n,defaultValue:t,defaultValueKey:r,pageSize:i=10,enabled:u=!0})=>{const{searchValue:f,onSearchValueChange:p,query:m}=S(),v=r||"id",{data:y}=x({queryKey:a,queryFn:async()=>s({[v]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:h,...d}=g({queryKey:[...a,m],queryFn:async({pageParam:e=0})=>await s({q:m,limit:i,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),o=(h==null?void 0:h.pages.flatMap(e=>n(e)))??[],l=y?n(y):[],D=!d.isPending&&!o.length&&!f||!u;return t&&l.length&&!f&&l.forEach(e=>{o.find(b=>b.value===e.value)||o.unshift(e)}),{options:o,searchValue:f,onSearchValueChange:p,disabled:D,...d}};export{S as a,I as u};
